2026-01-28 15:25:08,472 - INFO - Logging configured. Log file saved to: xxxxxxxxxxxxxxxxxxxxxxxxxxxxBrainLM-main/output/ppmi1/logs/finetune_process.log
2026-01-28 15:25:08,474 - INFO - Random seed set to: 225
2026-01-28 15:25:08,474 - INFO - Configuration:
2026-01-28 15:25:08,474 - INFO - Batch Size: 4, LR: 8e-05, Epochs: 10
2026-01-28 15:25:08,479 - INFO - Using device: cuda:7
2026-01-28 15:25:08,666 - INFO - Loading checkpoint from *******
2026-01-28 15:25:09,452 - INFO - --- ÂºÄÂßãÊâßË°å Key Êò†Â∞ÑËΩ¨Êç¢ ---
2026-01-28 15:25:09,452 - INFO - ËΩ¨Êç¢Á§∫‰æã (Checkpoint -> Model):
2026-01-28 15:25:09,452 - INFO -   vit.embeddings.cls_token  ==>  embeddings.cls_token (Â§ßËá¥)
2026-01-28 15:25:09,452 - INFO -   vit.embeddings.signal_embedding_projection.weight  ==>  embeddings.signal_embedding_projection.weight (Â§ßËá¥)
2026-01-28 15:25:09,452 - INFO -   vit.embeddings.signal_embedding_projection.bias  ==>  embeddings.signal_embedding_projection.bias (Â§ßËá¥)
2026-01-28 15:25:09,458 - INFO - 
==============================
2026-01-28 15:25:09,458 - INFO - Âä†ËΩΩÁªìÊûúÊä•Âëä
2026-01-28 15:25:09,458 - INFO - ==============================
2026-01-28 15:25:09,458 - INFO - ‚úÖ Encoder ÊùÉÈáçÂÖ®ÈÉ®Âä†ËΩΩÊàêÂäüÔºÅ
2026-01-28 15:25:09,458 - INFO - ‚úÖ ‰ø°Âè∑ÊäïÂΩ±Â±Ç (Signal Projection) Âä†ËΩΩÊàêÂäü„ÄÇ
2026-01-28 15:25:09,458 - INFO - ‚úÖ CLS Token Âä†ËΩΩÊàêÂäü„ÄÇ
2026-01-28 15:25:09,762 - INFO - Loading Datasets...
2026-01-28 15:25:09,845 - INFO - Train samples: 331, Val samples: 47, Test samples: 96
2026-01-28 15:25:09,864 - INFO - Starting Fine-tuning...
2026-01-28 15:25:10,678 - INFO - Epoch [1/10], Step [0], Loss: 0.7591
2026-01-28 15:25:18,171 - INFO - Epoch [1/10], Step [10], Loss: 0.5362
2026-01-28 15:25:25,458 - INFO - Epoch [1/10], Step [20], Loss: 0.3602
2026-01-28 15:25:32,660 - INFO - Epoch [1/10], Step [30], Loss: 0.8143
2026-01-28 15:25:39,848 - INFO - Epoch [1/10], Step [40], Loss: 0.6891
2026-01-28 15:25:46,067 - INFO - Epoch [1/10], Step [50], Loss: 0.8017
2026-01-28 15:25:51,557 - INFO - Epoch [1/10], Step [60], Loss: 0.6279
2026-01-28 15:25:58,011 - INFO - Epoch [1/10], Step [70], Loss: 0.4812
2026-01-28 15:26:05,402 - INFO - Epoch [1/10], Step [80], Loss: 0.4034
2026-01-28 15:26:06,258 - INFO - Epoch 1 Finished. Train Loss: 0.6975 | Train Acc: 0.5488 | Train F1: 0.5370
2026-01-28 15:26:06,258 - INFO - Running Validation for Epoch 1...
2026-01-28 15:26:10,038 - INFO - [Val] Loss: 0.6747 | Accuracy: 0.5957 | F1: 0.5610
2026-01-28 15:26:10,039 - INFO - Running Testing for Epoch 1...
2026-01-28 15:26:18,320 - INFO - [Test] Loss: 0.7199 | Accuracy: 0.5521 | F1: 0.5168
2026-01-28 15:26:18,376 - INFO - Saved checkpoint to xxxxxxxxxxxxxxxxxxxxxxxxxxxxBrainLM-main/output/ppmi1/finetuned_checkpoint_epoch_1.pt
2026-01-28 15:26:18,444 - INFO - üèÜ New Best Model (Val Acc: 0.5957, Val F1: 0.5610) saved to xxxxxxxxxxxxxxxxxxxxxxxxxxxxBrainLM-main/output/ppmi1/finetuned_checkpoint_best.pt
2026-01-28 15:26:19,220 - INFO - Epoch [2/10], Step [0], Loss: 0.7155
2026-01-28 15:26:26,059 - INFO - Epoch [2/10], Step [10], Loss: 0.9567
2026-01-28 15:26:32,318 - INFO - Epoch [2/10], Step [20], Loss: 0.8551
2026-01-28 15:26:38,377 - INFO - Epoch [2/10], Step [30], Loss: 0.9157
2026-01-28 15:26:45,363 - INFO - Epoch [2/10], Step [40], Loss: 0.6944
2026-01-28 15:26:52,457 - INFO - Epoch [2/10], Step [50], Loss: 0.5366
2026-01-28 15:26:58,656 - INFO - Epoch [2/10], Step [60], Loss: 0.8187
2026-01-28 15:27:02,548 - INFO - Epoch [2/10], Step [70], Loss: 0.5538
2026-01-28 15:27:06,054 - INFO - Epoch [2/10], Step [80], Loss: 0.7401
2026-01-28 15:27:06,551 - INFO - Epoch 2 Finished. Train Loss: 0.6654 | Train Acc: 0.6067 | Train F1: 0.5908
2026-01-28 15:27:06,551 - INFO - Running Validation for Epoch 2...
2026-01-28 15:27:08,909 - INFO - [Val] Loss: 0.6791 | Accuracy: 0.5957 | F1: 0.4792
2026-01-28 15:27:08,909 - INFO - Running Testing for Epoch 2...
2026-01-28 15:27:13,560 - INFO - [Test] Loss: 0.7123 | Accuracy: 0.5625 | F1: 0.4605
2026-01-28 15:27:15,986 - INFO - Saved checkpoint to xxxxxxxxxxxxxxxxxxxxxxxxxxxxBrainLM-main/output/ppmi1/finetuned_checkpoint_epoch_2.pt
2026-01-28 15:27:16,607 - INFO - Epoch [3/10], Step [0], Loss: 1.0999
2026-01-28 15:27:23,527 - INFO - Epoch [3/10], Step [10], Loss: 0.5717
2026-01-28 15:27:29,602 - INFO - Epoch [3/10], Step [20], Loss: 0.5828
2026-01-28 15:27:36,616 - INFO - Epoch [3/10], Step [30], Loss: 0.6703
2026-01-28 15:27:43,280 - INFO - Epoch [3/10], Step [40], Loss: 0.8701
2026-01-28 15:27:49,414 - INFO - Epoch [3/10], Step [50], Loss: 0.6840
2026-01-28 15:27:56,519 - INFO - Epoch [3/10], Step [60], Loss: 0.6473
2026-01-28 15:28:03,067 - INFO - Epoch [3/10], Step [70], Loss: 0.5559
2026-01-28 15:28:09,929 - INFO - Epoch [3/10], Step [80], Loss: 0.8152
2026-01-28 15:28:10,659 - INFO - Epoch 3 Finished. Train Loss: 0.6808 | Train Acc: 0.5762 | Train F1: 0.5509
2026-01-28 15:28:10,659 - INFO - Running Validation for Epoch 3...
2026-01-28 15:28:13,896 - INFO - [Val] Loss: 0.6705 | Accuracy: 0.6170 | F1: 0.5624
2026-01-28 15:28:13,896 - INFO - Running Testing for Epoch 3...
2026-01-28 15:28:21,527 - INFO - [Test] Loss: 0.6955 | Accuracy: 0.5417 | F1: 0.5023
2026-01-28 15:28:21,585 - INFO - Saved checkpoint to xxxxxxxxxxxxxxxxxxxxxxxxxxxxBrainLM-main/output/ppmi1/finetuned_checkpoint_epoch_3.pt
2026-01-28 15:28:21,629 - INFO - üèÜ New Best Model (Val Acc: 0.6170, Val F1: 0.5624) saved to xxxxxxxxxxxxxxxxxxxxxxxxxxxxBrainLM-main/output/ppmi1/finetuned_checkpoint_best.pt
2026-01-28 15:28:22,172 - INFO - Epoch [4/10], Step [0], Loss: 0.5254
2026-01-28 15:28:28,586 - INFO - Epoch [4/10], Step [10], Loss: 0.9605
2026-01-28 15:28:35,026 - INFO - Epoch [4/10], Step [20], Loss: 0.8224
2026-01-28 15:28:41,466 - INFO - Epoch [4/10], Step [30], Loss: 0.3505
2026-01-28 15:28:47,608 - INFO - Epoch [4/10], Step [40], Loss: 0.8066
2026-01-28 15:28:54,217 - INFO - Epoch [4/10], Step [50], Loss: 0.7188
2026-01-28 15:29:01,094 - INFO - Epoch [4/10], Step [60], Loss: 0.5597
2026-01-28 15:29:07,552 - INFO - Epoch [4/10], Step [70], Loss: 0.5056
2026-01-28 15:29:15,304 - INFO - Epoch [4/10], Step [80], Loss: 0.4017
2026-01-28 15:29:15,854 - INFO - Epoch 4 Finished. Train Loss: 0.6510 | Train Acc: 0.6220 | Train F1: 0.6093
2026-01-28 15:29:15,854 - INFO - Running Validation for Epoch 4...
2026-01-28 15:29:19,339 - INFO - [Val] Loss: 0.7234 | Accuracy: 0.5532 | F1: 0.5148
2026-01-28 15:29:19,340 - INFO - Running Testing for Epoch 4...
2026-01-28 15:29:27,059 - INFO - [Test] Loss: 0.7795 | Accuracy: 0.5312 | F1: 0.5004
2026-01-28 15:29:27,112 - INFO - Saved checkpoint to xxxxxxxxxxxxxxxxxxxxxxxxxxxxBrainLM-main/output/ppmi1/finetuned_checkpoint_epoch_4.pt
2026-01-28 15:29:27,854 - INFO - Epoch [5/10], Step [0], Loss: 0.5528
2026-01-28 15:29:34,741 - INFO - Epoch [5/10], Step [10], Loss: 0.4797
2026-01-28 15:29:40,740 - INFO - Epoch [5/10], Step [20], Loss: 0.8771
2026-01-28 15:29:47,190 - INFO - Epoch [5/10], Step [30], Loss: 0.6458
2026-01-28 15:29:54,937 - INFO - Epoch [5/10], Step [40], Loss: 0.4707
2026-01-28 15:30:01,583 - INFO - Epoch [5/10], Step [50], Loss: 0.7057
2026-01-28 15:30:08,016 - INFO - Epoch [5/10], Step [60], Loss: 0.9570
2026-01-28 15:30:14,665 - INFO - Epoch [5/10], Step [70], Loss: 0.7787
2026-01-28 15:30:20,652 - INFO - Epoch [5/10], Step [80], Loss: 0.8726
2026-01-28 15:30:21,297 - INFO - Epoch 5 Finished. Train Loss: 0.6712 | Train Acc: 0.6189 | Train F1: 0.6000
2026-01-28 15:30:21,298 - INFO - Running Validation for Epoch 5...
2026-01-28 15:30:24,708 - INFO - [Val] Loss: 0.6741 | Accuracy: 0.5957 | F1: 0.5610
2026-01-28 15:30:24,708 - INFO - Running Testing for Epoch 5...
2026-01-28 15:30:31,485 - INFO - [Test] Loss: 0.7148 | Accuracy: 0.5104 | F1: 0.4647
2026-01-28 15:30:31,532 - INFO - Saved checkpoint to xxxxxxxxxxxxxxxxxxxxxxxxxxxxBrainLM-main/output/ppmi1/finetuned_checkpoint_epoch_5.pt
2026-01-28 15:30:32,204 - INFO - Epoch [6/10], Step [0], Loss: 0.7197
2026-01-28 15:30:39,020 - INFO - Epoch [6/10], Step [10], Loss: 0.7592
2026-01-28 15:30:45,659 - INFO - Epoch [6/10], Step [20], Loss: 0.5690
2026-01-28 15:30:51,669 - INFO - Epoch [6/10], Step [30], Loss: 0.5114
2026-01-28 15:30:55,218 - INFO - Epoch [6/10], Step [40], Loss: 0.8989
2026-01-28 15:30:58,334 - INFO - Epoch [6/10], Step [50], Loss: 0.7004
2026-01-28 15:31:02,178 - INFO - Epoch [6/10], Step [60], Loss: 0.5528
2026-01-28 15:31:06,859 - INFO - Epoch [6/10], Step [70], Loss: 0.7354
2026-01-28 15:31:13,371 - INFO - Epoch [6/10], Step [80], Loss: 0.4920
2026-01-28 15:31:13,920 - INFO - Epoch 6 Finished. Train Loss: 0.6376 | Train Acc: 0.6189 | Train F1: 0.5974
2026-01-28 15:31:13,920 - INFO - Running Validation for Epoch 6...
2026-01-28 15:31:17,546 - INFO - [Val] Loss: 0.7278 | Accuracy: 0.4468 | F1: 0.4504
2026-01-28 15:31:17,546 - INFO - Running Testing for Epoch 6...
2026-01-28 15:31:24,086 - INFO - [Test] Loss: 0.7748 | Accuracy: 0.4688 | F1: 0.4643
2026-01-28 15:31:24,137 - INFO - Saved checkpoint to xxxxxxxxxxxxxxxxxxxxxxxxxxxxBrainLM-main/output/ppmi1/finetuned_checkpoint_epoch_6.pt
2026-01-28 15:31:24,677 - INFO - Epoch [7/10], Step [0], Loss: 0.8591
2026-01-28 15:31:31,347 - INFO - Epoch [7/10], Step [10], Loss: 0.5871
2026-01-28 15:31:37,921 - INFO - Epoch [7/10], Step [20], Loss: 0.6828
2026-01-28 15:31:45,563 - INFO - Epoch [7/10], Step [30], Loss: 0.4145
2026-01-28 15:31:53,779 - INFO - Epoch [7/10], Step [40], Loss: 0.6089
2026-01-28 15:32:00,274 - INFO - Epoch [7/10], Step [50], Loss: 0.7391
2026-01-28 15:32:07,195 - INFO - Epoch [7/10], Step [60], Loss: 0.5748
2026-01-28 15:32:14,277 - INFO - Epoch [7/10], Step [70], Loss: 0.8246
2026-01-28 15:32:20,477 - INFO - Epoch [7/10], Step [80], Loss: 0.6502
2026-01-28 15:32:21,196 - INFO - Epoch 7 Finished. Train Loss: 0.6481 | Train Acc: 0.6159 | Train F1: 0.6002
2026-01-28 15:32:21,196 - INFO - Running Validation for Epoch 7...
2026-01-28 15:32:24,528 - INFO - [Val] Loss: 0.7074 | Accuracy: 0.5957 | F1: 0.5817
2026-01-28 15:32:24,528 - INFO - Running Testing for Epoch 7...
2026-01-28 15:32:32,523 - INFO - [Test] Loss: 0.7760 | Accuracy: 0.5000 | F1: 0.4887
2026-01-28 15:32:32,995 - INFO - Saved checkpoint to xxxxxxxxxxxxxxxxxxxxxxxxxxxxBrainLM-main/output/ppmi1/finetuned_checkpoint_epoch_7.pt
2026-01-28 15:32:33,598 - INFO - Epoch [8/10], Step [0], Loss: 0.5613
2026-01-28 15:32:40,682 - INFO - Epoch [8/10], Step [10], Loss: 0.4012
2026-01-28 15:32:47,066 - INFO - Epoch [8/10], Step [20], Loss: 0.7785
2026-01-28 15:32:53,269 - INFO - Epoch [8/10], Step [30], Loss: 0.9780
2026-01-28 15:32:59,641 - INFO - Epoch [8/10], Step [40], Loss: 0.5309
2026-01-28 15:33:06,173 - INFO - Epoch [8/10], Step [50], Loss: 0.8488
2026-01-28 15:33:12,506 - INFO - Epoch [8/10], Step [60], Loss: 0.6459
2026-01-28 15:33:19,499 - INFO - Epoch [8/10], Step [70], Loss: 0.3557
2026-01-28 15:33:26,112 - INFO - Epoch [8/10], Step [80], Loss: 0.5662
2026-01-28 15:33:26,739 - INFO - Epoch 8 Finished. Train Loss: 0.6373 | Train Acc: 0.6463 | Train F1: 0.6253
2026-01-28 15:33:26,739 - INFO - Running Validation for Epoch 8...
2026-01-28 15:33:30,084 - INFO - [Val] Loss: 0.6627 | Accuracy: 0.6170 | F1: 0.5203
2026-01-28 15:33:30,085 - INFO - Running Testing for Epoch 8...
2026-01-28 15:33:36,452 - INFO - [Test] Loss: 0.7692 | Accuracy: 0.5208 | F1: 0.4453
2026-01-28 15:33:36,498 - INFO - Saved checkpoint to xxxxxxxxxxxxxxxxxxxxxxxxxxxxBrainLM-main/output/ppmi1/finetuned_checkpoint_epoch_8.pt
2026-01-28 15:33:37,269 - INFO - Epoch [9/10], Step [0], Loss: 0.5513
2026-01-28 15:33:43,851 - INFO - Epoch [9/10], Step [10], Loss: 0.6186
2026-01-28 15:33:50,166 - INFO - Epoch [9/10], Step [20], Loss: 0.6701
2026-01-28 15:33:56,077 - INFO - Epoch [9/10], Step [30], Loss: 0.5430
2026-01-28 15:34:02,183 - INFO - Epoch [9/10], Step [40], Loss: 0.2791
2026-01-28 15:34:08,531 - INFO - Epoch [9/10], Step [50], Loss: 1.1882
2026-01-28 15:34:15,266 - INFO - Epoch [9/10], Step [60], Loss: 0.7890
2026-01-28 15:34:21,621 - INFO - Epoch [9/10], Step [70], Loss: 0.6347
2026-01-28 15:34:28,613 - INFO - Epoch [9/10], Step [80], Loss: 0.8183
2026-01-28 15:34:29,170 - INFO - Epoch 9 Finished. Train Loss: 0.6289 | Train Acc: 0.6341 | Train F1: 0.6276
2026-01-28 15:34:29,171 - INFO - Running Validation for Epoch 9...
2026-01-28 15:34:32,453 - INFO - [Val] Loss: 0.7199 | Accuracy: 0.4468 | F1: 0.3885
2026-01-28 15:34:32,454 - INFO - Running Testing for Epoch 9...
2026-01-28 15:34:39,289 - INFO - [Test] Loss: 0.8003 | Accuracy: 0.4896 | F1: 0.4295
2026-01-28 15:34:39,336 - INFO - Saved checkpoint to xxxxxxxxxxxxxxxxxxxxxxxxxxxxBrainLM-main/output/ppmi1/finetuned_checkpoint_epoch_9.pt
2026-01-28 15:34:40,078 - INFO - Epoch [10/10], Step [0], Loss: 1.0405
2026-01-28 15:34:43,176 - INFO - Epoch [10/10], Step [10], Loss: 0.4187
2026-01-28 15:34:49,717 - INFO - Epoch [10/10], Step [20], Loss: 0.6098
2026-01-28 15:34:57,006 - INFO - Epoch [10/10], Step [30], Loss: 0.5479
2026-01-28 15:35:03,438 - INFO - Epoch [10/10], Step [40], Loss: 0.4591
2026-01-28 15:35:09,330 - INFO - Epoch [10/10], Step [50], Loss: 0.2290
2026-01-28 15:35:15,508 - INFO - Epoch [10/10], Step [60], Loss: 0.2798
2026-01-28 15:35:22,205 - INFO - Epoch [10/10], Step [70], Loss: 0.5225
2026-01-28 15:35:28,706 - INFO - Epoch [10/10], Step [80], Loss: 0.4113
2026-01-28 15:35:29,286 - INFO - Epoch 10 Finished. Train Loss: 0.5806 | Train Acc: 0.6951 | Train F1: 0.6814
2026-01-28 15:35:29,286 - INFO - Running Validation for Epoch 10...
2026-01-28 15:35:32,786 - INFO - [Val] Loss: 0.8517 | Accuracy: 0.5106 | F1: 0.5021
2026-01-28 15:35:32,786 - INFO - Running Testing for Epoch 10...
2026-01-28 15:35:39,305 - INFO - [Test] Loss: 0.9285 | Accuracy: 0.5000 | F1: 0.4849
2026-01-28 15:35:39,357 - INFO - Saved checkpoint to xxxxxxxxxxxxxxxxxxxxxxxxxxxxBrainLM-main/output/ppmi1/finetuned_checkpoint_epoch_10.pt
2026-01-28 15:35:39,357 - INFO - Loading best checkpoint for final test...
2026-01-28 15:35:40,318 - INFO - Running Testing for Best Checkpoint...
2026-01-28 15:35:46,985 - INFO - [BestTest] Loss: 0.6956 | Accuracy: 0.5417 | F1: 0.5023
2026-01-28 15:35:46,985 - INFO - Training Complete.
